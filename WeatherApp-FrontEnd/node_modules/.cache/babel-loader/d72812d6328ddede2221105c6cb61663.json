{"ast":null,"code":"var _jsxFileName = \"/Users/xinjin/Documents/Exercise/WeatherApp/weather-app/src/components/WealtherApp/WealtherApp.js\";\nimport React, { Component } from 'react';\nimport moment from 'moment';\nimport WeatherForm from '../WeatherForm/WeatherForm';\nimport SearchWeatherByCity from '../SearchWeatherByCity/SearchWeatherByCity';\nimport WeatherAppService from \"../../APIs/WeatherDataAPI/WeatherAppService\";\nimport HeaderComponent from '../HeaderComponent/HeaderComponent';\nimport SubHeaderComponent from '../HeaderComponent/SubHeaderComponent';\nimport ErrorMessage from '../ErrorMessage/ErrorMessage';\n\nclass WealtherApp extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      this.accessWeatherDataHandler('', this.state.isMetric);\n    };\n\n    this.searchClickedHandler = cityName => {\n      if (cityName !== this.state.cityName) this.accessWeatherDataHandler(cityName, this.state.isMetric);\n    };\n\n    this.accessWeatherDataHandler = (cityName, isMetric) => {\n      WeatherAppService.retrieveLocalWeather(cityName).then(response => {\n        let currentWeather = [];\n        response.data.list.map(day => {\n          let temp = day.main.temp;\n\n          if (!isMetric) {\n            temp = Math.round(temp * 9 / 5 + 32);\n          }\n\n          currentWeather.push({\n            hour: moment(day.dt_txt).format('HH'),\n            city: cityName,\n            temperature: temp\n          });\n        });\n        this.setState({\n          currentWeatherData: [...currentWeather],\n          wealtherInfo: [...response.data.list],\n          receivedData: !this.state.receivedData,\n          cityName: cityName,\n          goBack: !this.state.goBack,\n          retrieveDataFailed: false,\n          iconType: response.data.list[0].weather[0].main\n        });\n      }).catch(error => {\n        this.setState({\n          errorMessage: \"Couldn't find the weather data for this city\",\n          retrieveDataFailed: true\n        });\n      });\n    };\n\n    this.clearClickedHandler = () => {\n      this.setState({\n        // receivedData: !this.state.receivedData\n        isMetric: !this.state.isMetric\n      }); // console.log(this.state.isMetric)\n    };\n\n    this.state = {\n      cityName: '',\n      currentDate: moment(new Date()).format('YYYY-MM-DD'),\n      currentWeatherData: [],\n      receivedData: false,\n      wealtherInfo: [],\n      retrieveDataFailed: false,\n      errorMessage: \"\",\n      isMetric: false\n    };\n    this.searchClickedHandler = this.searchClickedHandler.bind(this);\n    this.clearClickedHandler = this.clearClickedHandler.bind(this);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid h-100 w-100 row align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid h-20 w-100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }\n    }, this.state.receivedData && /*#__PURE__*/React.createElement(HeaderComponent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 12\n      }\n    }), !this.state.receivedData && /*#__PURE__*/React.createElement(SubHeaderComponent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 12\n      }\n    }), this.state.receivedData && /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-success btn-lg\",\n      onClick: this.clearClickedHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 12\n      }\n    }, \"Clear\"), !this.state.receivedData && /*#__PURE__*/React.createElement(SearchWeatherByCity, {\n      searchClickedHandler: this.searchClickedHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 12\n      }\n    })), this.state.receivedData && /*#__PURE__*/React.createElement(WeatherForm, {\n      cityName: this.state.cityName,\n      currentDate: this.state.currentDate,\n      currentWeatherData: this.state.currentWeatherData,\n      wealtherInfo: this.state.wealtherInfo,\n      iconType: this.state.iconType,\n      isMetric: this.state.isMetric,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 12\n      }\n    }), this.state.retrieveDataFailed && /*#__PURE__*/React.createElement(ErrorMessage, {\n      message: this.state.errorMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 12\n      }\n    }));\n  }\n\n}\n\nexport default WealtherApp;","map":{"version":3,"sources":["/Users/xinjin/Documents/Exercise/WeatherApp/weather-app/src/components/WealtherApp/WealtherApp.js"],"names":["React","Component","moment","WeatherForm","SearchWeatherByCity","WeatherAppService","HeaderComponent","SubHeaderComponent","ErrorMessage","WealtherApp","constructor","props","componentDidMount","accessWeatherDataHandler","state","isMetric","searchClickedHandler","cityName","retrieveLocalWeather","then","response","currentWeather","data","list","map","day","temp","main","Math","round","push","hour","dt_txt","format","city","temperature","setState","currentWeatherData","wealtherInfo","receivedData","goBack","retrieveDataFailed","iconType","weather","catch","error","errorMessage","clearClickedHandler","currentDate","Date","bind","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport moment from 'moment'\n\nimport WeatherForm from '../WeatherForm/WeatherForm'\nimport SearchWeatherByCity from '../SearchWeatherByCity/SearchWeatherByCity'\nimport WeatherAppService from \"../../APIs/WeatherDataAPI/WeatherAppService\"\nimport HeaderComponent from '../HeaderComponent/HeaderComponent'\nimport SubHeaderComponent from '../HeaderComponent/SubHeaderComponent'\nimport ErrorMessage from '../ErrorMessage/ErrorMessage'\n\nclass WealtherApp extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cityName: '',\n      currentDate: moment(new Date()).format('YYYY-MM-DD'),\n      currentWeatherData: [],\n      receivedData: false,\n      wealtherInfo: [],\n      retrieveDataFailed: false,\n      errorMessage: \"\",\n      isMetric: false\n    };\n    this.searchClickedHandler = this.searchClickedHandler.bind(this);\n    this.clearClickedHandler = this.clearClickedHandler.bind(this);\n  }\n\n  componentDidMount = () => {\n    this.accessWeatherDataHandler('', this.state.isMetric);\n  }\n  // componentDidUpdate(prevProps) {\n  //   if( this.props.isMetric !== prevProps.isMetric){\n  //     this.setState({isMetric: prevProps.isMetric});\n  //   }\n  // } \n  searchClickedHandler = (cityName) => {\n    if (cityName !== this.state.cityName)\n    this.accessWeatherDataHandler(cityName, this.state.isMetric);\n  }\n\n  accessWeatherDataHandler = (cityName, isMetric) => {\n    WeatherAppService.retrieveLocalWeather(cityName)\n      .then(response => {\n        let currentWeather = [];\n        response.data.list.map( day => {\n          let temp = day.main.temp;\n          if (!isMetric) {\n            temp = Math.round(temp * 9/5 + 32);\n          }\n          currentWeather.push({\n            hour: moment(day.dt_txt).format('HH'),\n            city: cityName,\n            temperature: temp\n          })\n        });\n        this.setState({\n          currentWeatherData: [...currentWeather],\n          wealtherInfo: [...response.data.list],\n          receivedData: !this.state.receivedData,\n          cityName: cityName,\n          goBack: !this.state.goBack,\n          retrieveDataFailed: false,\n          iconType: response.data.list[0].weather[0].main\n        });\n      }).catch(error => {\n        this.setState({\n          errorMessage: \"Couldn't find the weather data for this city\",\n          retrieveDataFailed: true\n        })\n      });\n  }\n\n  clearClickedHandler = () => {\n    this.setState({\n      // receivedData: !this.state.receivedData\n      isMetric: !this.state.isMetric\n    })\n    // console.log(this.state.isMetric)\n  }\n  \n  render() {\n    return (\n      <div className=\"container-fluid h-100 w-100 row align-items-center\">\n        <div className=\"container-fluid h-20 w-100\">\n        {this.state.receivedData \n        && <HeaderComponent />}\n        {!this.state.receivedData \n        && <SubHeaderComponent />}\n        {this.state.receivedData \n        && <button className=\"btn btn-success btn-lg\" \n        onClick={this.clearClickedHandler}>Clear</button>}\n        {!this.state.receivedData \n        && <SearchWeatherByCity  searchClickedHandler={this.searchClickedHandler}/>}\n        </div>\n        {this.state.receivedData\n        && <WeatherForm \n          cityName={this.state.cityName}\n          currentDate={this.state.currentDate}\n          currentWeatherData={this.state.currentWeatherData}\n          wealtherInfo={this.state.wealtherInfo}\n          iconType={this.state.iconType}\n          isMetric={this.state.isMetric}\n        />}\n        {this.state.retrieveDataFailed \n        && <ErrorMessage message={this.state.errorMessage} />}\n      </div>\n    );\n  }\n}\n\nexport default WealtherApp;"]},"metadata":{},"sourceType":"module"}